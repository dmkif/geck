- name: clone dns-updater
  git:
    repo: https://github.com/LINKIWI/cloudflare-ddns-client.git
    dest: /home/k8s/dns-updater

- name: install dns-updater
  shell: make install
  args:
    chdir: /home/k8s/dns-updater

- name: copy dns-updater configuration
  template:
    src: ./cloudflare-ddns
    dest: /home/k8s/.cloudflare-ddns

- name: create dns-updater cron job
  cron:
    minute="0"
    hour="0"
    name="dns-updater"
    job="/usr/local/bin/cloudflare-ddns --update-now > /dev/null 2>&1"
