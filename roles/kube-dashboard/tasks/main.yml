---
- name: Download dashboard yaml
  get_url:
    url: "https://raw.githubusercontent.com/kubernetes/dashboard/{{ kube_dashboard_version }}/aio/deploy/recommended.yaml"
    dest: "{{ temp_dir }}/dashboard.aio.yaml"

- name: Copy service files
  copy:
    src: "{{ item }}"
    dest: "{{ temp_dir }}/{{ item }}"
  with_items:
    - dashboard.admin-user.yaml
    - dashboard.admin-user-role.yaml

- name: Creating deployment
  k8s:
    state: present
    kubeconfig: /etc/rancher/k3s/k3s.yaml
    src: "{{ temp_dir }}/{{ item }}"
  with_items:
    - dashboard.aio.yaml
    - dashboard.admin-user.yaml
    - dashboard.admin-user-role.yaml
